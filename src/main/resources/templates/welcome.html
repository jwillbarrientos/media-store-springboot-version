<!DOCTYPE html>
<html lang="en">
<head th:replace="fragments :: head('Media Store Welcome')"></head>

<body>
<link rel="stylesheet" th:href="@{/css/welcome.css}">
<!-- Top header -->
<header>

    <div class="logo">Media-Store</div>

    <div class="profile">
        <span th:text="${email}"></span>
        <button id="changePasswordBtn">Change Password</button>
        <button id="deleteAccountBtn">Delete Account</button>
        <button id="signOutBtn">Sign Out</button>
    </div>
</header>

<div class="layout">

    <!-- Sidebar -->
    <aside>
        <div class="tags-title">
            My Tags
            <button id="createTag">+</button>
        </div>
        <br>
        <!-- Tags list -->
        <div id="tagList">
            <div th:each="tag : ${tags}">
                <span class="tag-name" th:text="${tag.name}" th:attr="data-tag-id=${tag.id}" style="cursor:pointer;"></span>
                <button class="tag-action-btn edit-btn" th:onclick="'editTag(' + ${tag.id} + ');'">Edit</button>
                <button class="tag-action-btn delete-btn" th:onclick="'deleteTag(' + ${tag.id} + ');'">Delete</button>
            </div>
        </div>
        <div class="sidebar-actions">
            <button id="showAllBtn" class="sidebar-btn">Show All Videos</button>
            <button id="videosShortBtn" class="sidebar-btn">Short Videos (60s or less)</button>
            <button id="videosLongBtn" class="sidebar-btn">Long Videos (over 60s)</button>
            <button id="videosWithTagsBtn" class="sidebar-btn">Videos With Tags</button>
            <button id="videosWithoutTagsBtn" class="sidebar-btn">Videos Without Tags</button>
        </div>
    </aside>

    <!-- Main content -->
    <main>
        <div class="upload-section">
            <!-- Single Video Upload -->
            <section class="upload-box">
                <h2>Upload individual video</h2>
                <input id="videoUrl" type="text" placeholder="Paste here your link...">
                <button id="uploadBtn">Upload</button>
            </section>

            <!-- WhatsApp Chat Upload -->
            <section class="upload-box">
                <h2>WhatsApp Chat</h2>

                <div id="whatsappUploadArea" style="border: 2px dashed #ccc; border-radius: 10px; text-align: center; padding: 25px;">
                    <p>ðŸ“„ Drag or select the exported chat file</p>
                    <input type="file" id="whatsappFile" accept=".txt" style="display:none;">
                    <label for="whatsappFile" style="color:#007bff; cursor:pointer; text-decoration:underline;">Select File</label>
                </div>

                <button id="processChatBtn" style="width:100%; margin-top:15px; padding:10px; background:#28a745; border:none; color:white; font-weight:bold; border-radius:6px; cursor:pointer;">
                    Process Chat
                </button>
            </section>
        </div>

        <!-- Videos section -->
        <div class="video-header">
            <h3>Last 10 videos uploaded</h3>
        </div>
        <div id="videoContainer" style="margin-top: 30px;"></div>
    </main>

</div>

<!-- Tag Selection Modal -->
<div id="tag-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.75); color: white; z-index: 50; align-items: center; justify-content: center;">
    <div style="background: #111; padding: 20px; border-radius: 12px; max-width: 320px; width: 90%; text-align: left;">
        <h2 style="margin-bottom: 10px;">Manage Tags</h2>
        <div id="tag-list" style="max-height: 300px; overflow-y: auto;"></div>
        <button id="close-modal" class="control-button" style="margin-top: 15px;">Close</button>
    </div>
</div>

<script type="module" th:src="@{/js/createtag.js}" defer></script>
<script type="module" th:src="@{/js/edittag.js}" defer></script>
<script type="module" th:src="@{/js/deletetag.js}" defer></script>
<script type="module" th:src="@{/js/addvideobylink.js}" defer></script>
<script type="module" th:src="@{/js/addsinglevideotolibrary.js}" defer></script>
<script type="module" th:src="@{/js/processwhatsappchat.js}" defer></script>
<script type="module" th:src="@{/js/showvideoswithspecifictag.js}" defer></script>
<script type="module" th:src="@{/js/showallvideos.js}" defer></script>
<script type="module" th:src="@{/js/showshortvideos.js}" defer></script>
<script type="module" th:src="@{/js/showlongvideos.js}" defer></script>
<script type="module" th:src="@{/js/showvideoswithtags.js}" defer></script>
<script type="module" th:src="@{/js/showvideoswithouttags.js}" defer></script>
<script type="module" th:src="@{/js/deleteaccount.js}" defer></script>
<script type="module" th:src="@{/js/changepassword.js}" defer></script>
<script type="module" th:src="@{/js/signout.js}" defer></script>

<script>
    window.onload = function() {
        const fileInput = document.getElementById("whatsappFile");
        const uploadArea = document.getElementById("whatsappUploadArea");
        const uploadText = document.getElementById("uploadText");

        fileInput.addEventListener("change", () => {
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];

                // Change style and text
                uploadArea.style.borderColor = "#28a745";
                uploadArea.style.backgroundColor = "#e8fbe8";
                uploadText.textContent = `âœ… File selected: ${file.name}`;
            }
        });
    };
</script>

</body>
</html>
